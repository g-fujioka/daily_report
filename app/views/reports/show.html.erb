<% provide(:button_text, 'コメントする') %>

<h1><%= @report.user.name %>の日報</h1>
<table border="1">
  <tr><td>日付</td><td><%= @report.report_date %></td></tr>
  <tr><td>タイトル</td><td><%= @report.title %></td></tr>
  <tr><td>内容</td><td><%= @report.content %></td></tr>
</table>
<% if current_user?(@report.user) %>
<%= link_to '編集', edit_report_path %>   <%= link_to '削除', @report, method: :delete,
            data: { confirm: "削除しますか？" } %><br>
<% end %>
<table border="1" class="comment-table">
<!-- コメントとコメントフォーム -->
  <tr><th>ユーザー名</th><th>コメント</th></tr>
<% @comments.each do |comment| %>
  <tr>
    <td><%= comment.user.name %></td>
    <td><%= comment.content %></td>
    <td>    <% if current_user?(comment.user) %>
          <%= link_to '削除', comment, method: :delete %><br>
      <% end %></td>
  </tr>
<% end %>
</table>

<% unless current_user?(@report.user) %>
<%= form_for(@comment) do |f| %>

    <%= render 'shared/error_messages', object: @comment %>

    <%= f.label :content %>
    <%= f.text_area :content, class: 'form-control' %>

    <%= f.hidden_field :report_id, value: @report.id %>

    <%= f.hidden_field :user_id, value: current_user.id %>

    <%= f.submit yield(:button_text), class: "btn btn-primary" %>
<% end %>
<% end %>